# ðŸ”§ Troubleshooting Guide - Web Configuration Interface

## Common Issues and Solutions

### Issue 1: "Failed to fetch current configuration" - 404 Error

**Symptom:** When you click "Save Changes", you get an error about failing to fetch configuration.

**Cause:** The `bills_to_track.json` file doesn't exist in your repository yet.

**Solution Option A: Upload the File First (Recommended)**

1. **Go to your repository** on GitHub
2. Click **"Add file"** â†’ **"Upload files"**
3. Upload the `bills_to_track_initial.json` file (rename it to `bills_to_track.json` when uploading)
4. Commit the file
5. **Now try the web interface again** - it should work!

**Solution Option B: Create the File Manually**

1. **Go to your repository** on GitHub
2. Click **"Add file"** â†’ **"Create new file"**
3. **Filename:** `bills_to_track.json`
4. **Content:**
```json
{
  "bills": [],
  "settings": {
    "notification_email": null,
    "sync_frequency": "daily",
    "timezone": "America/New_York"
  }
}
```
5. Click **"Commit changes"**
6. **Now try the web interface again**

**Solution Option C: Use the Updated Web Interface**

The latest version of `track_bills.py` now automatically creates the file if it doesn't exist. Make sure you're using the updated version!

---

### Issue 2: "Invalid token" or "Bad credentials"

**Symptom:** Error says your token is invalid even though you just created it.

**Causes & Solutions:**

**1. Token doesn't have "repo" scope**
- Go to https://github.com/settings/tokens
- Find your token (or create a new one)
- Make sure **"repo"** checkbox is checked
- If you need to create a new token, delete the old one

**2. Token has expired**
- Check the expiration date of your token
- Create a new token if needed

**3. Copy/paste error**
- Token should start with `ghp_` followed by letters and numbers
- Make sure you copied the entire token
- No spaces before or after

**Fix:**
1. Create a new token: https://github.com/settings/tokens/new
2. **Description:** "Virginia Bill Tracker"
3. **Expiration:** 90 days (or longer)
4. **Scopes:** Check âœ… **repo** (full control)
5. Click **"Generate token"**
6. **Copy the token immediately** (you can't see it again!)
7. Paste in web interface

---

### Issue 3: "Repository not found"

**Symptom:** Error says the repository doesn't exist.

**Cause:** Repository name in the dashboard doesn't match your actual repository.

**Solution:**

The dashboard gets the repository name from the environment variable during workflow runs. If you haven't run the workflow yet, it might show a placeholder.

**Quick Fix:**
1. Check your actual repository name on GitHub
2. Open browser developer tools (F12)
3. In Console, type:
```javascript
REPO_NAME = 'YOUR-USERNAME/virginia-bill-tracker'
```
Replace with your actual username and repo name
4. Try saving again

**Permanent Fix:**
1. Run the workflow at least once (Actions â†’ Run workflow)
2. This will set the correct repository name
3. Refresh your dashboard page

---

### Issue 4: "Token does not have access" or "Resource not accessible"

**Symptom:** Error says token can't access the repository.

**Causes:**

**1. Wrong repository**
- Token is for a different GitHub account
- Repository name is incorrect

**2. Repository is private but token is from organization**
- Check if repository belongs to an organization
- Check if your token has organization access

**Solutions:**

1. **Verify repository ownership:**
   - Go to the repository
   - Check the URL: `github.com/USERNAME/REPO-NAME`
   - Make sure USERNAME matches the account that created the token

2. **Check token permissions:**
   - Go to https://github.com/settings/tokens
   - Click on your token
   - Verify it has **repo** access
   - If it's an organization repo, may need admin:org scope

3. **Create a new token with correct permissions:**
   - Delete old token
   - Create new one with proper scopes
   - Use the new token in web interface

---

### Issue 5: Modal doesn't open or "Configure Bills" button doesn't work

**Symptom:** Nothing happens when you click "Configure Bills"

**Solutions:**

**1. Check browser console for errors**
- Press F12 to open developer tools
- Click "Console" tab
- Look for red error messages
- Share them if you need help

**2. Clear browser cache**
- Hard refresh: Ctrl+Shift+R (Windows) or Cmd+Shift+R (Mac)
- Or clear browser cache for github.io

**3. Try a different browser**
- Test in Chrome, Firefox, or Edge
- Some browser extensions might interfere

**4. Check if JavaScript is enabled**
- The interface requires JavaScript
- Check browser settings

---

### Issue 6: Bills not showing after save

**Symptom:** You saved successfully but bills don't appear on dashboard.

**Cause:** Dashboard needs to be regenerated by workflow.

**Solution:**

1. **Verify file was updated:**
   - Go to repository on GitHub
   - Click `bills_to_track.json`
   - Check if your bills are in the file
   - Look at commit history to see recent update

2. **Run workflow to update dashboard:**
   - Go to **Actions** tab
   - Click **"Track Virginia Bills"**
   - Click **"Run workflow"**
   - Wait 1-2 minutes

3. **Refresh dashboard:**
   - Hard refresh: Ctrl+Shift+R (Windows/Linux) or Cmd+Shift+R (Mac)
   - Clear browser cache if needed

---

### Issue 7: CORS error in browser console

**Symptom:** See "CORS" or "Cross-Origin" error in console.

**Cause:** Browser security preventing cross-origin requests.

**This is normal and expected!** The configuration interface works by making requests to GitHub API from your browser. Some browsers show CORS warnings but they don't prevent the functionality.

**If it's actually blocking:**
- Make sure you're on the correct dashboard URL (github.io)
- Try a different browser
- Check if browser extensions are interfering

---

### Issue 8: Accidentally committed wrong bills

**Symptom:** You saved the wrong bills and want to undo.

**Solution:**

**Option 1: Fix via Web Interface**
1. Open dashboard
2. Click "Configure Bills"
3. Remove wrong bills (click Ã—)
4. Add correct bills
5. Save changes

**Option 2: Edit on GitHub**
1. Go to repository
2. Click `bills_to_track.json`
3. Click edit (pencil icon)
4. Fix the bills array
5. Commit changes

**Option 3: Revert commit**
1. Go to repository
2. Click "commits"
3. Find the wrong commit
4. Click "..."  â†’ "Revert"
5. Confirm revert

---

## Verification Checklist

Before reporting an issue, verify:

- [ ] `bills_to_track.json` file exists in repository root
- [ ] Repository is public (or token has org access if private)
- [ ] Token has "repo" scope enabled
- [ ] Token hasn't expired
- [ ] You copied the full token (starts with `ghp_`)
- [ ] Repository name in REPO_NAME matches your actual repo
- [ ] Workflow has run at least once
- [ ] You're using the latest version of track_bills.py

---

## Still Having Issues?

### Getting More Information

1. **Open browser console** (F12)
2. Try saving again
3. **Look for errors** in Console tab
4. Check Network tab for failed requests

### What to include when asking for help

1. **Exact error message** from the dashboard
2. **Screenshot** of the error
3. **Browser console logs** (F12 â†’ Console)
4. **Network tab details** (F12 â†’ Network â†’ look for red/failed requests)
5. Your **repository URL** (without token!)
6. What **steps you tried** already

### Where to get help

1. **Check this troubleshooting guide first**
2. **Read GH_PAGES_SETUP.md** for setup issues
3. **Open an issue** in your repository with details
4. Include all information from "What to include" above

---

## Quick Reference Commands

### Check if file exists via API
```bash
curl -H "Authorization: token YOUR_TOKEN" \
  https://api.github.com/repos/YOUR-USERNAME/virginia-bill-tracker/contents/bills_to_track.json
```

### Manually create file via API
```bash
curl -X PUT \
  -H "Authorization: token YOUR_TOKEN" \
  -H "Accept: application/vnd.github.v3+json" \
  https://api.github.com/repos/YOUR-USERNAME/virginia-bill-tracker/contents/bills_to_track.json \
  -d '{"message":"Create bills_to_track.json","content":"ewogICJiaWxscyI6IFtdLAogICJzZXR0aW5ncyI6IHsKICAgICJub3RpZmljYXRpb25fZW1haWwiOiBudWxsLAogICAgInN5bmNfZnJlcXVlbmN5IjogImRhaWx5IiwKICAgICJ0aW1lem9uZSI6ICJBbWVyaWNhL05ld19Zb3JrIgogIH0KfQ=="}'
```

---

**Remember:** The most common issue is missing `bills_to_track.json` file. Always create it first!
